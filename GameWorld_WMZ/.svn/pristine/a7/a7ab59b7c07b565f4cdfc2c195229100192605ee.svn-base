#include "gameserver.h"
#include "gamehoster.h"
#include <QDebug>


GameServer *GameServer::_instance = 0;

GameServer::GameServer(QObject *parent)
{

    this->_server = new QTcpServer;
    this->_server->listen(QHostAddress::Any, TCP_CONNECTION_PORT);

    QObject::connect(_server, SIGNAL(newConnection()), this, SLOT(incomingConnection()));
}

void GameServer::CreateServer()
{
    if (GameServer::_instance == nullptr) {

        _instance = new GameServer();
    }
}

void GameServer::DestoryServer() {


}

GameServer *GameServer::Instance() {

    return GameServer::_instance;
}

void GameServer::incomingConnection()
{
    //get the pending socket and push it on the list
    QTcpSocket *clientSocket = this->_server->nextPendingConnection();
    this->_clientSockets.push_back(clientSocket);

    qDebug() << "connection received";
}

void GameServer::run()
{

}
